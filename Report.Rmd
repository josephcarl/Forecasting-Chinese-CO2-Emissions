---
title: "Forecasting Chinese Carbon Dioxide Emissions"
author: "Joseph Carl"
date: "June 7, 2017"
output: html_notebook
---

## Introduction

research question/motivation, description of topic, lit. review

Over the past several decades, China's economy has experienced explosive growth. While China's economic development has lifted millions out of poverty and increased its citizens' quality of life, it has also led to unintended consequences, including increased pollution levels. Pollution has been linked to many health issues, and carbon dioxide pollution is the main driver of global climate change. Additionally, as of 2007, China is now the largest contributor to global carbon emissions. Understanding how emissions have changed over time and forecasting emissions in future years is vital to understanding the trajectory that Chinese emissions are taking. Forecasts are also necessary to begin implementing policies that will decrease the country's emissions. The purpose of this analysis is to model Chinese carbon dioxide (CO~2~) emissions per capita over time and to forecast emissions per capita for future periods.


```{r setup, echo=FALSE}
# Required libraries and functions
library(readxl)
library(tidyverse)
library(urca)
library(dynlm)
library(forecast)
source("Functions_ECON_5305.R")
source("data_cleaning_transformation.R")
```

## Data

description of data, data source(s), transformations to data, unit root tests, maybe some EDA

The data for this analysis was taken from Gapminder, an independent Swedish foundation dedicated to educating the public about global development and using statistics to promote a fact-based worldview. Though the data was downloaded from gapminder.org, it was compiled there from numerous sources. The CO~2~ emissions data are from the Carbon Dioxide Information Analysis Center at the U.S. Department of Energy. Other potential explanatory variables include electricity consumption per capita, coal consumption per capita, amount of industry as a percentage of GDP, and GDP per capita growth rates, as these may also explain a large portion of the variation in CO~2~ emissions per capita over time. The data on GDP growth rates, industry as a percentage of GDP, and electricity consumption per capita are from the World Bank DataBank. The data on coal consumption per capita comes from BP. If I can find historical data on China's unemployment and poverty rates, I will include those, as they may also explain variation in Chinese individuals' aggregate consumption, and thus variation in CO~2~ emissions per capita.

The data is annual data ranging from 1971-2010 (exact years may vary slightly after data cleaning and differencing). The final four observations will be excluded from the analysis as validation data so that the forecasts can be compared to their actual values and thus assess the forecast's accuracy.


## Methodology

research question, empirical methods (VAR), lag order selection, logic behind imposing the structure, how methodology will answer research question

### Unit Root Tests

Though the initial data comes in its original units (tonnes of CO~2~ per capita, GDP per capita growth, and tonnes of oil equivalent per person), it is appropriate to test for a unit root on each of these variables. Because vector autoregression models are built from autoregressive properties, I test for a unit root to make sure the process being modeled is covariance stationary. Making sure that each variable is covariance stationary will also help with selecting the correct number of lags that should be included in the model. A quick look at each of the three variables suggests that annual CO~2~ emissions and coal consumption may not be covariance stationary, but GDP growth per capita might be stationary.

```{r, echo=FALSE, fig.height=2}
local({
  par(mfrow=c(1,3))
  ts.plot(China.co2, main="Annual CO2 Emissions", xlab = "Year", ylab = "Tonnes/Person")
  ts.plot(ChinaGDPgrowth, main="GDP Growth per Capita", xlab="Year", ylab = "% Change")
  ts.plot(ChinaCoal, main="Annual Coal Consumption", xlab = "Year", ylab = "Tonnes of Oil Equivalent/Person")
})
```

To test for unit root, I use the augmented Dickey-Fuller test. The augmented Dickey Fuller tests the null hypothesis that the data is non-stationary against the alternate hypothesis that the data is stationary. The test must be run under three separate cases: that the data follows a random walk without drift or trend, a random walk with drift but no trend, or a random walk with drift and trend. The results of the augmented Dickey-Fuller tests are displayed for each variable are displayed in the following table.

```{r, echo=FALSE}
##### Unit Root Tests #####
print("Annual CO2 Emissions")
adf.results(China.co2, max.lags = 1) %>% as.data.frame(.)
print("Annual GDP per Capita Growth")
adf.results(ChinaGDPgrowth, max.lags = 1) %>% as.data.frame(.)
print("Annual Coal Consumption")
adf.results(ChinaCoal, max.lags = 1) %>% as.data.frame(.)
```

As the results show, we fail to reject the null hypothesis of nonstationarity for annual carbon dioxide emissions and coal consumption. However, we are able to reject the null hypothesis that GDP per capita growth is nonstationary in favor of the alternate hypothesis that it is stationary. This makes sense because this variable is already a growth rate, and growth rates tend to be stationary. I then log-difference the CO~2~ emissions and coal consumption data so that those transformed variables are the growth rates of the original variables, and rerun the augmented Dickey-Fuller test on the transformed data. Those results are presented below.

```{r, echo=FALSE}
# CO2 growth
print("Change in Annual CO2 Emissions (%)")
adf.results(g.China, max.lags = 1) %>% as.data.frame(.)
print("Change in Annual Coal Consumption (%)")
adf.results(g.coal, max.lags = 1) %>% as.data.frame(.)

```

The results show that on the transformed data, we can now safely reject the null hypothesis that the growth rates of CO~2~ emissions and coal consumption are nonstationary in favor of the alternate hypothesis that they are stationary. These two transformed variables along with the GDP growth rate will be used in the VAR model.

As the following graph shows, both transformed variables appear much more stationary than their original versions appeared.

```{r, echo=FALSE}
local({
  par(mfrow=c(1,2))
  ts.plot(g.China, main=expression(paste(Delta, "Annual CO2 Emissions")), 
          xlab="Year", ylab="% Change")
  ts.plot(g.coal, main=expression(paste(Delta, "Annual Coal Consumption")), 
          xlab="Year", ylab="% Change")
})
```

### Lag Order Selection

Knowing that the three variables for the model are now stationary, it is important to enter the correct number of lags into the vector autoregression model. I examine the autocorrelation function (ACF) and partial autocorrelation function (PACF) of each variable as a way to gauge which number of lags is appropriate. The number of statistically significant spikes in the ACF corresponds to the order of the underlying moving average (MA) process, and the number of statistically significant spikes in the PACF corresponds to the order of the underlying autoregressive (AR) process. Because vector autoregression only uses autoregressive variables, I am more interested in the AR order. The ACF and PACF of each series is given in the following graphs, where the blue dotted bands are the cutoff for statistical significance. Lags falling outside of the blue band are statistically different from zero, indicating they have explanatory power for their respective series.

```{r, echo=FALSE}
local({
  par(mfrow=c(3,2), mar=c(2,4,4,4)) # Adjust margins so graphs don't overlap
  Acf(g.China, lag.max = 10, main="ACF of CO2 Growth Rate")
  Pacf(g.China, lag.max = 10, main="PACF of CO2 Growth Rate")
  Acf(ChinaGDPgrowth, lag.max = 10, main="ACF of GDP Growth Rate")
  Pacf(ChinaGDPgrowth, lag.max = 10, main="PACF of GDP Growth Rate")
  Acf(g.coal, lag.max = 10, main="ACF of Coal Growth Rate")
  Pacf(g.coal, lag.max = 10, main="PACF of Coal Growth Rate")
})
```

For the CO~2~ growth rate, there is one statistically significant spike in both the ACF and PACF, suggesting that series follows an ARMA(1,1) process. The GDP growth rates have two statistically significant spikes in the PACF, and the first and sixth spikes in the ACF are statistically significant. This suggests the series could follow an ARMA(2,1) or ARMA(2,6) process. However, since I am more interested in the AR(2) piece for the VAR model, I do not explore that further. The coal growth rate has two statistically significant spikes in the PACF, and the first and third lags of the ACF are statistically significant, suggesting either an AR(2,1) or AR(2,3) process. Looking at only the AR lags, the variables have AR processes of 1, 2, and 2, so I will use two lags for each variable in the VAR model. As the CO~2~ per capita growth rate appears to be an AR(1) process, the effect of its second lag will likely be statistically no different than zero.

### The Reduced-Form VAR Model

I estimate the reduced form VAR model of the following form:

$$\begin{bmatrix}
    \Delta CO_2\\
    \Delta GDP \\
    \Delta Coal\end{bmatrix} 
    =
    \begin{bmatrix}
    \delta_{10} \\
    \delta_{20} \\
    \delta_{30}\end{bmatrix} 
    +
    \begin{bmatrix}
    \delta_{11} + \delta_{12} + \delta_{13} \\
    \delta_{21} + \delta_{22} + \delta_{23}\\
    \delta_{31} + \delta_{32} + \delta_{33}\end{bmatrix} 
    \times
    \begin{bmatrix}
    \Delta CO_{2.t-1}\\
    \Delta GDP_{t-1} \\
    \Delta Coal_{t-1} \end{bmatrix}
    +
    \begin{bmatrix}
    \delta_{14} + \delta_{15} + \delta_{16} \\
    \delta_{24} + \delta_{25} + \delta_{26}\\
    \delta_{34} + \delta_{35} + \delta_{36}\end{bmatrix} 
    \times
    \begin{bmatrix}
    \Delta CO_{2.t-2}\\
    \Delta GDP_{t-2} \\
    \Delta Coal_{t-2} \end{bmatrix}$$

My goal is to recover the original structural parameters: $\mathbf{A_0}, \mathbf{\Gamma_0}, \mathbf{\Gamma_1}, \mathbf{\Gamma_2}$. Simply put, I am estimating three separate equations, each of which says that the change in CO~2~ emissions per capita, GDP growth, and change in coal consumption per capita are functions of the previous two years' change in CO~2~ emissions per capita, GDP growth, and change in coal consumption per capita. 

### Logic Behind Imposing the Structure

## Results

results, tables, economic interpretation, forecast a few periods?

## Conclusion

and shortcomings of model

## Sources

Boden, T.A., G. Marland, and R.J. Andres. 2013. "Global, Regional, and National Fossil-Fuel CO2 Emissions." Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory, U.S. Department of Energy, Oak Ridge, Tenn., U.S.A. doi 10.3334/CDIAC/00001_V2013

"BP statistical review of world energy." British Petroleum.  http://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-world-energy.html (2012).

"DataBank: World Development Indicators." The World Bank. http://databank.worldbank.org (2017).

Rosling, Hans. "Gapminder." GapMinder Foundation http://www.gapminder.org 91 (2009).

